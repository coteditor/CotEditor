<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="keywords" content="スクリプトメニュー,スクリプト">
	<link rel="stylesheet" href="../../Shared/sty/standard.css">
	<script defer src="../../Shared/js/toc.js"></script>
	
	<title>MacのCotEditorでスクリプトメニューをカスタマイズする</title>
</head>

<body>

<h1>MacのCotEditorでスクリプトメニューをカスタマイズする</h1>

<p>スクリプトフォルダのスクリプトのファイル名にある特定のテキストを含めることで、メニューでの表示順を変更したりスクリプトにキーボードショートカットを付与したりできます。</p>


<section>
<h2>スクリプトメニューの項目を並び替える</h2>

<p>ファイル名の先頭に「01)」のように数字と半角の閉じ括弧をつけると、その数字の順に項目を並べることができます。数字と閉じ括弧の部分はメニュー項目では表示されません。</p>

<p>以下に例を挙げます:</p>
<table>
	<thead>
		<tr><th>ファイル名</th><th>メニューでの表示</th></tr>
	</thead>
	<tbody>
		<tr>
			<td><strong>01)</strong>Open File.scpt</td>
			<td>Open File</td>
		</tr>
	</tbody>
</table>
</section>


<section>
<h2>スクリプトメニューに区切り線を追加する</h2>

<p>「-」という名前のファイルやフォルダやファイルはメニューの区切り線として認識されます。さらにフォルダ名の先頭に数字と閉じ括弧をつけることで、任意のメニュー項目の間に挿入できます。</p>
</section>


<section>
<h2>非表示のファイル/フォルダを置く</h2>

<p>「_」から名前が始まるファイルやフォルダはスクリプトメニューに表示されません。設定ファイルやライブラリスクリプトなどに利用できます。</p>
</section>


<section>
<h2>サブメニューを作る</h2>

<p>スクリプトフォルダにはフォルダも置くことができます。フォルダはサブメニューとして表示されます。</p>
</section>


<section>
<h2>スクリプトにキーボードショートカットを割り当てる</h2>

<p>ファイル名の拡張子の直前に「. + 修飾キー + ショートカットキー』を追加すると、スクリププトの実行にキーボードショートカットを割り当てることができます。</p>

<ul>
	<li><p>ショートカットキー（修飾キーでないキー、例えば「e」や「Y」）は小文字で記述します。大文字のときは「Shiftキーも同時に押す」として認識されます。</p></li>
	<li><p>ショートカットキーは修飾キーのあとに書かなければなりません。1文字だけ指定できます。ファイル名に使えないキー（<kbd>F1</kbd>や<kbd>Delete</kbd>など）は割り当てられません。</p></li>
	<li><p>指定したキーボードショートカットがすでにほかの機能に割り当てられているとき、スクリプトのショートカットは無視されます。</p></li>
</ul>

<p>修飾キーは以下の記号で示します:</p>
<table>
	<thead>
		<tr><th>表記</th><th>キー</th></tr>
	</thead>
	<tbody>
		<tr><td>^</td><td><kbd>Control</kbd></td></tr>
		<tr><td>$</td><td><kbd>Shift</kbd></td></tr>
		<tr><td>~</td><td><kbd>Option</kbd></td></tr>
		<tr><td>@</td><td><kbd>Command</kbd></td></tr>
	</tbody>
</table>

<p>例えば、ファイル名に対して、それぞれメニューで表示されるスクリプト名と割り当てられるショートカットキーは以下のようになります:</p>
<table>
	<thead>
		<tr><th>ファイル名</th><th>メニューでの表示</th><th>ショートカット</th></tr>
	</thead>
	<tbody>
		<tr>
			<td>テキストを挿入<strong>.@e</strong>.scpt</td>
			<td>テキストを挿入</td>
			<td><kbd>Command</kbd>+<kbd>E</kbd></td>
		</tr>
		<tr>
			<td>03)日付を挿入<strong>.@~Y</strong>.scpt</td>
			<td>日付を挿入</td>
			<td><kbd>Command</kbd>+<kbd>Option</kbd>+<kbd>Shift</kbd>+<kbd>Y</kbd></td>
		</tr>
	</tbody>
</table>


<h3>複数のスクリプトに同一のショートカットを割り当てる</h3>

<p>複数のスクリプトに同一のショートカットが割り付けられていたときは、CotEditorは現在の書類のシンタックスと同じ名前のサブフォルダの中にあるスクリプトに優先してショートカットを割り当てます。</p>
</section>


<section id="cf">
<h2>関連項目</h2>
<ul>
	<li><a href="script_overview.html">MacのCotEditorの作業をスクリプトで自動化する</a></li>
</ul>
</section>

</body>
</html>
